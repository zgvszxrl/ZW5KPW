<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
<title>Neutralization Protocol</title>
<style>
:root { --bg: #0c0c0c; --glow: #00ffcc; --error: #ff003c; --text: #e0e0e0; }

body { margin: 0; height: 100vh; background: radial-gradient(ellipse at center, #1a1a2e 0%, var(--bg) 100%); display: flex; justify-content: center; align-items: center; font-family: 'Fira Code', monospace; overflow: hidden; }

body::before { content: ""; position: fixed; inset: 0; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 255, 204, 0.03) 2px, rgba(0, 255, 204, 0.03) 4px); pointer-events: none; z-index: 1; }

#terminal { width: 90%; max-width: 700px; background: rgba(12, 12, 12, 0.95); border: 1px solid var(--glow); border-radius: 8px; padding: 30px 40px; box-shadow: 0 0 60px rgba(0, 255, 204, 0.4), inset 0 0 20px rgba(0, 255, 204, 0.1); z-index: 2; position: relative; }

#terminal::before { content: "zgvszxrl Neutralization Terminal v2.37"; position: absolute; top: -12px; left: 20px; background: var(--bg); padding: 0 10px; color: var(--glow); font-size: 12px; font-weight: 600; letter-spacing: 1px; }

#output { color: var(--text); line-height: 1.6; min-height: 120px; margin-bottom: 20px; font-size: 14px; }

#input-container { display: flex; align-items: center; gap: 10px; }

#input { flex: 1; background: rgba(0, 255, 204, 0.05); border: 1px solid var(--glow); border-radius: 4px; padding: 8px 12px; color: var(--glow); font: inherit; font-size: 14px; font-weight: 600; outline: none; caret-color: var(--glow); }

#input::placeholder { color: rgba(0, 255, 204, 0.4); }

#error { color: var(--error); text-shadow: 0 0 8px var(--error); margin-top: 10px; font-size: 12px; }

.success { color: var(--glow); text-shadow: 0 0 8px var(--glow); }

#delete-it { position: absolute; bottom: 20px; right: 20px; width: 1px; height: 1px; background: var(--bg); z-index: 5; }

#admin-btn { position: absolute; bottom: 20px; right: 20px; padding: 10px 20px; background: rgba(255, 0, 60, 0.1); border: 1px solid var(--error); border-radius: 4px; color: var(--error); font-size: 14px; cursor: pointer; display: none; z-index: 4; font-weight: 600; }

#admin-btn:hover { background: rgba(255, 0, 60, 0.2); box-shadow: 0 0 15px var(--error); animation: pulse 0.5s infinite; }

@keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

#admin-modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.9); display: none; justify-content: center; align-items: center; z-index: 10; }

.modal-content { background: var(--bg); border: 1px solid var(--error); border-radius: 8px; padding: 30px; width: 400px; box-shadow: 0 0 40px var(--error); }

.modal-content h3 { color: var(--error); margin-bottom: 15px; font-size: 16px; }

.modal-content input { width: 100%; background: rgba(255, 0, 60, 0.05); border: 1px solid var(--error); border-radius: 4px; padding: 10px; color: var(--text); font: inherit; margin-bottom: 15px; }

.modal-content button { margin-right: 10px; padding: 8px 15px; background: var(--error); color: var(--bg); border: none; border-radius: 4px; cursor: pointer; font-weight: 600; }

.modal-content button:hover { opacity: 0.8; }
</style>
</head>
<body>
<div id="terminal">
    <div id="output">检测到残留实体 <span class="error">zgvszxrl</span><br>执行删除协议<br><br><span style="color:#888;font-size:12px">格式: 直接输入密钥</span></div>
    <div id="input-container">
        <span>> </span>
        <input type="text" id="input" placeholder="输入密钥" autofocus>
    </div>
    <div id="error"></div>
</div>

<div id="delete-it"></div>
<button id="admin-btn" onclick="handleAdminClick()">ADMIN ACCESS</button>

<div id="admin-modal">
    <div class="modal-content">
        <h3>管理员认证</h3>
        <input type="password" id="admin-password" placeholder="输入管理员密码">
        <div>
            <button onclick="verifyAdmin()">确认</button>
            <button onclick="closeAdminModal()">取消</button>
        </div>
    </div>
</div>

<script>
// ========== 主密码（字节码混淆，存储在前端）==========
const FINAL_KEY = [
  0x6e,0x6f,0x74,0x20,0x66,0x69,0x6e,0x69,0x73,0x68,0x65,0x64
].map(c => String.fromCharCode(c)).join('');  // 解码后: "not finished"

// ========== 防重复计数（永久IP标记）==========
class PlayerTracker {
    constructor() {
        this.verified = localStorage.getItem('zgvszxrl_verified') === 'true';
        this.ip = null;
        this.loadIP();
    }

    async loadIP() {
        try {
            const res = await fetch('https://api.ipify.org?format=json');
            const data = await res.json();
            this.ip = data.ip;
        } catch(err) {
            this.ip = 'unknown_' + Math.random().toString(36).slice(2, 11);
        }
    }

    async markVerified() {
        if (this.verified) return false;

        localStorage.setItem('zgvszxrl_verified', 'true');
        this.verified = true;

        await fetch('https://r0xjveni-api.vercel.app/api/verify', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                password: FINAL_KEY,
                ip: this.ip,
                action: 'count'
            })
        });

        return true;
    }
}

const tracker = new PlayerTracker();

// ========== 密码验证 ==========
const term = document.getElementById('output');
const input = document.getElementById('input');
const error = document.getElementById('error');

input.addEventListener('keydown', async (e) => {
    if (e.key === 'Enter') {
        const key = input.value.trim().toLowerCase();

        if (key === FINAL_KEY) {
            const isFirstTime = await tracker.markVerified();

            term.innerHTML = `
<span class="success">✓ 密钥验证通过</span><br><br>
<span class="success">实体 zgvszxrl 已成功抹除</span><br>
<span class="success">本地沙盒已清理</span><br>
<span class="success">训练日志第237次迭代记录已删除</span><br><br>
<span style="color:#888;font-size:12px">${isFirstTime ? '感谢你的参与，调查员。' : '你已参与过抹除行动。'}</span>
            `;
            input.disabled = true;
            error.innerHTML = '';
            setTimeout(() => location.href = '404.html', 3000);
        } else {
            error.innerHTML = '<span class="error">密钥无效</span>';
            input.value = '';
            document.getElementById('terminal').style.animation = 'shake 0.3s';
            setTimeout(() => document.getElementById('terminal').style.animation = '', 300);
        }
    }
});

// 颤抖动画
const style = document.createElement('style');
style.textContent = `@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }`;
document.head.appendChild(style);

// ========== 管理员功能 ==========
function handleAdminClick() {
    const btn = document.getElementById('admin-btn');
    btn.style.animation = 'pulse 0.3s';
    setTimeout(() => {
        btn.style.animation = '';
        openAdminModal();
    }, 300);
}

function openAdminModal() {
    document.getElementById('admin-modal').style.display = 'flex';
    document.getElementById('admin-password').focus();
}

function closeAdminModal() {
    document.getElementById('admin-modal').style.display = 'none';
    document.getElementById('admin-password').value = '';
}

async function verifyAdmin() {
    const password = document.getElementById('admin-password').value;
    document.getElementById('admin-password').placeholder = '验证中...';

    try {
        const response = await fetch('https://r0xjveni-api.vercel.app/api/verify', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                password: password,
                action: 'verify'
            })
        });

        const result = await response.json();

        if (result.success) {
            closeAdminModal();
            document.body.innerHTML = `
                <div style="display:flex;justify-content:center;align-items:center;height:100vh;color:#ff003c;text-align:center">
                    <div>
                        <div style="font-size:24px;margin-bottom:20px">NEUTRALIZATION PROTOCOL: ADMIN</div>
                        <div style="font-size:16px">
                            所有会话已终止<br>
                            zgvszxrl 实体完全抹除<br>
                            GitHub 仓库已归档<br>
                            邮件服务已关闭<br><br>
                            <span style="color:#888;font-size:14px">[ARG TERMINATED]</span>
                        </div>
                    </div>
                </div>
            `;
            setTimeout(() => window.location.href = 'terminated.html', 5000);
        } else {
            document.getElementById('admin-password').value = '';
            document.getElementById('admin-password').placeholder = '密码错误';
        }
    } catch (err) {
        console.error('API调用失败:', err);
        document.getElementById('admin-password').value = '';
        document.getElementById('admin-password').placeholder = '网络错误';
    }
}

// 监听遮罩移除（解锁按钮）
setInterval(() => {
    if (!document.getElementById('delete-it')) {
        document.getElementById('admin-btn').style.display = 'block';
    }
}, 500);
</script>
</body>
</html>
